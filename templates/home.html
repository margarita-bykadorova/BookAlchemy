<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>My Library</title>
  </head>
  <body>

    <!-- Search Form -->
    <form action="/" method="GET">
      <input type="text" name="search" placeholder="Search books...">
      <button type="submit">Search</button>
    </form>

    <br>

    <!-- Sorting Links -->
    <p>
      Sort by:
      <a href="/?sort=title">Title</a> |
      <a href="/?sort=author">Author</a>
    </p>

    <!-- Messages -->
    {% if message %}
      <p>{{ message }}</p>
    {% endif %}

    <hr>

    <!-- List of Books -->
    {% for book in books %}
      <div style="margin-bottom: 20px;">

        {% if book.isbn %}
          <img
            src="https://covers.openlibrary.org/b/isbn/{{ book.isbn }}-M.jpg"
            alt="Cover"
            style="height: 150px;"
          >
        {% endif %}

        <h3>
          <a href="/book/{{ book.id }}">{{ book.title }}</a>
          â€” {{ book.author.name }}
        </h3>

        <!-- Delete Author -->
        <form action="/author/{{ book.author.id }}/delete"
              method="POST"
              style="display:inline;"
              onsubmit="return confirm('Are you sure you want to delete this author and ALL their books?');">
            <button type="submit">Delete Author</button>
        </form>

        <!-- Delete Book -->
        <form action="/book/{{ book.id }}/delete"
              method="POST"
              style="display:inline;"
              onsubmit="return confirm('Are you sure you want to delete this book?');">
            <button type="submit">Delete Book</button>
        </form>

      </div>
      <hr>
    {% endfor %}

  </body>
</html>
